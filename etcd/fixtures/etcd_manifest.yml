director_uuid: some-director-uuid

name: etcd

compilation:
  cloud_properties: {}
  network: etcd1
  reuse_compilation_vms: true
  workers: 3

jobs:
- instances: 1
  name: consul_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.39
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: consul_agent
    release: consul
  properties:
    consul:
      agent:
        mode: server
- instances: 1
  name: etcd_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.34
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: etcd
    release: etcd
  - name: consul_agent
    release: consul
  properties:
    consul:
      agent:
        services:
          etcd: {}
- instances: 1
  name: testconsumer_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.40
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: consul_agent
    release: consul
  - name: etcd-test-consumer
    release: etcd

networks:
- name: etcd1
  subnets:
  - cloud_properties:
      name: random
    range: 10.244.4.0/24
    gateway: 10.244.4.1
    reserved:
    - 10.244.4.2-10.244.4.3
    - 10.244.4.104-10.244.4.254
    static:
    - 10.244.4.4
    - 10.244.4.5
    - 10.244.4.6
    - 10.244.4.7
    - 10.244.4.8
    - 10.244.4.9
    - 10.244.4.10
    - 10.244.4.11
    - 10.244.4.12
    - 10.244.4.13
    - 10.244.4.14
    - 10.244.4.15
    - 10.244.4.16
    - 10.244.4.17
    - 10.244.4.18
    - 10.244.4.19
    - 10.244.4.20
    - 10.244.4.21
    - 10.244.4.22
    - 10.244.4.23
    - 10.244.4.24
    - 10.244.4.25
    - 10.244.4.26
    - 10.244.4.27
    - 10.244.4.28
    - 10.244.4.29
    - 10.244.4.30
    - 10.244.4.31
    - 10.244.4.32
    - 10.244.4.33
    - 10.244.4.34
    - 10.244.4.35
    - 10.244.4.36
    - 10.244.4.37
    - 10.244.4.38
    - 10.244.4.39
    - 10.244.4.40
    - 10.244.4.41
    - 10.244.4.42
    - 10.244.4.43
    - 10.244.4.44
    - 10.244.4.45
    - 10.244.4.46
    - 10.244.4.47
    - 10.244.4.48
    - 10.244.4.49
    - 10.244.4.50
    - 10.244.4.51
    - 10.244.4.52
    - 10.244.4.53
    - 10.244.4.54
    - 10.244.4.55
    - 10.244.4.56
    - 10.244.4.57
    - 10.244.4.58
    - 10.244.4.59
    - 10.244.4.60
    - 10.244.4.61
    - 10.244.4.62
    - 10.244.4.63
    - 10.244.4.64
    - 10.244.4.65
    - 10.244.4.66
    - 10.244.4.67
    - 10.244.4.68
    - 10.244.4.69
    - 10.244.4.70
    - 10.244.4.71
    - 10.244.4.72
    - 10.244.4.73
    - 10.244.4.74
    - 10.244.4.75
    - 10.244.4.76
    - 10.244.4.77
    - 10.244.4.78
    - 10.244.4.79
    - 10.244.4.80
    - 10.244.4.81
    - 10.244.4.82
    - 10.244.4.83
    - 10.244.4.84
    - 10.244.4.85
    - 10.244.4.86
    - 10.244.4.87
    - 10.244.4.88
    - 10.244.4.89
    - 10.244.4.90
    - 10.244.4.91
    - 10.244.4.92
    - 10.244.4.93
    - 10.244.4.94
    - 10.244.4.95
    - 10.244.4.96
    - 10.244.4.97
    - 10.244.4.98
    - 10.244.4.99
    - 10.244.4.100
  type: manual

properties:
  etcd:
    cluster:
    - instances: 1
      name: etcd_z1
    machines:
    - etcd.service.cf.internal
    peer_require_ssl: true
    require_ssl: true
    heartbeat_interval_in_milliseconds: 50
    advertise_urls_dns_suffix: etcd.service.cf.internal
    ca_cert: etcd-ca-cert
    client_cert: etcd-client-cert
    client_key: etcd-client-key
    peer_ca_cert: etcd-peer-ca-cert
    peer_cert: etcd-peer-cert
    peer_key: etcd-peer-key
    server_cert: etcd-server-cert
    server_key: etcd-server-key
  consul:
    agent:
      domain: cf.internal
      servers:
        lan:
        - 10.244.4.39
    encrypt_keys:
    - consul-encrypt-key
    agent_cert: consul-agent-cert
    agent_key: consul-agent-key
    ca_cert: consul-ca-cert
    server_cert: consul-server-cert
    server_key: consul-server-key

releases:
- name: consul
  version: latest
- name: etcd
  version: latest

resource_pools:
- cloud_properties: {}
  name: etcd_z1
  network: etcd1
  stemcell:
    name: bosh-warden-boshlite-ubuntu-trusty-go_agent
    version: latest

update:
  canaries: 1
  canary_watch_time: 1000-180000
  max_in_flight: 1
  serial: true
  update_watch_time: 1000-180000

