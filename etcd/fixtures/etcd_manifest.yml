director_uuid: some-director-uuid

name: etcd

compilation:
  cloud_properties: {}
  network: etcd1
  reuse_compilation_vms: true
  workers: 3

jobs:
- instances: 1
  name: consul_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.45
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: consul_agent
    release: consul
  properties:
    consul:
      agent:
        mode: server
- instances: 1
  name: etcd_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.40
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: etcd
    release: etcd
  - name: consul_agent
    release: consul
  properties:
    consul:
      agent:
        services:
          etcd: {}
- instances: 1
  name: testconsumer_z1
  networks:
  - name: etcd1
    static_ips:
    - 10.244.4.46
  persistent_disk: 1024
  resource_pool: etcd_z1
  templates:
  - name: consul_agent
    release: consul
  - name: etcd-test-consumer
    release: etcd

networks:
- name: etcd1
  subnets:
  - cloud_properties:
      name: random
    range: 10.244.4.0/24
    gateway: 10.244.4.1
    reserved:
    - 10.244.4.2-10.244.4.3
    - 10.244.4.255
    static:
    - 10.244.4.10
    - 10.244.4.11
    - 10.244.4.12
    - 10.244.4.13
    - 10.244.4.14
    - 10.244.4.15
    - 10.244.4.16
    - 10.244.4.17
    - 10.244.4.18
    - 10.244.4.19
    - 10.244.4.20
    - 10.244.4.21
    - 10.244.4.22
    - 10.244.4.23
    - 10.244.4.24
    - 10.244.4.25
    - 10.244.4.26
    - 10.244.4.27
    - 10.244.4.28
    - 10.244.4.29
    - 10.244.4.30
    - 10.244.4.31
    - 10.244.4.32
    - 10.244.4.33
    - 10.244.4.34
    - 10.244.4.35
    - 10.244.4.36
    - 10.244.4.37
    - 10.244.4.38
    - 10.244.4.39
    - 10.244.4.40
    - 10.244.4.41
    - 10.244.4.42
    - 10.244.4.43
    - 10.244.4.44
    - 10.244.4.45
    - 10.244.4.46
    - 10.244.4.47
    - 10.244.4.48
    - 10.244.4.49
    - 10.244.4.50
    - 10.244.4.51
    - 10.244.4.52
    - 10.244.4.53
    - 10.244.4.54
    - 10.244.4.55
    - 10.244.4.56
    - 10.244.4.57
    - 10.244.4.58
    - 10.244.4.59
    - 10.244.4.60
    - 10.244.4.61
    - 10.244.4.62
    - 10.244.4.63
    - 10.244.4.64
    - 10.244.4.65
    - 10.244.4.66
    - 10.244.4.67
    - 10.244.4.68
    - 10.244.4.69
    - 10.244.4.70
    - 10.244.4.71
    - 10.244.4.72
    - 10.244.4.73
    - 10.244.4.74
    - 10.244.4.75
    - 10.244.4.76
    - 10.244.4.77
    - 10.244.4.78
    - 10.244.4.79
    - 10.244.4.80
    - 10.244.4.81
    - 10.244.4.82
    - 10.244.4.83
    - 10.244.4.84
    - 10.244.4.85
    - 10.244.4.86
    - 10.244.4.87
    - 10.244.4.88
    - 10.244.4.89
    - 10.244.4.90
    - 10.244.4.91
    - 10.244.4.92
    - 10.244.4.93
    - 10.244.4.94
    - 10.244.4.95
    - 10.244.4.96
    - 10.244.4.97
    - 10.244.4.98
    - 10.244.4.99
    - 10.244.4.100
    - 10.244.4.101
    - 10.244.4.102
    - 10.244.4.103
    - 10.244.4.104
    - 10.244.4.105
    - 10.244.4.106
    - 10.244.4.107
    - 10.244.4.108
    - 10.244.4.109
    - 10.244.4.110
    - 10.244.4.111
    - 10.244.4.112
    - 10.244.4.113
    - 10.244.4.114
    - 10.244.4.115
    - 10.244.4.116
    - 10.244.4.117
    - 10.244.4.118
    - 10.244.4.119
    - 10.244.4.120
    - 10.244.4.121
    - 10.244.4.122
    - 10.244.4.123
    - 10.244.4.124
    - 10.244.4.125
    - 10.244.4.126
    - 10.244.4.127
    - 10.244.4.128
    - 10.244.4.129
    - 10.244.4.130
    - 10.244.4.131
    - 10.244.4.132
    - 10.244.4.133
    - 10.244.4.134
    - 10.244.4.135
    - 10.244.4.136
    - 10.244.4.137
    - 10.244.4.138
    - 10.244.4.139
    - 10.244.4.140
    - 10.244.4.141
    - 10.244.4.142
    - 10.244.4.143
    - 10.244.4.144
    - 10.244.4.145
    - 10.244.4.146
    - 10.244.4.147
    - 10.244.4.148
    - 10.244.4.149
    - 10.244.4.150
    - 10.244.4.151
    - 10.244.4.152
    - 10.244.4.153
    - 10.244.4.154
    - 10.244.4.155
    - 10.244.4.156
    - 10.244.4.157
    - 10.244.4.158
    - 10.244.4.159
    - 10.244.4.160
    - 10.244.4.161
    - 10.244.4.162
    - 10.244.4.163
    - 10.244.4.164
    - 10.244.4.165
    - 10.244.4.166
    - 10.244.4.167
    - 10.244.4.168
    - 10.244.4.169
    - 10.244.4.170
    - 10.244.4.171
    - 10.244.4.172
    - 10.244.4.173
    - 10.244.4.174
    - 10.244.4.175
    - 10.244.4.176
    - 10.244.4.177
    - 10.244.4.178
    - 10.244.4.179
    - 10.244.4.180
    - 10.244.4.181
    - 10.244.4.182
    - 10.244.4.183
    - 10.244.4.184
    - 10.244.4.185
    - 10.244.4.186
    - 10.244.4.187
    - 10.244.4.188
    - 10.244.4.189
    - 10.244.4.190
    - 10.244.4.191
    - 10.244.4.192
    - 10.244.4.193
    - 10.244.4.194
    - 10.244.4.195
    - 10.244.4.196
    - 10.244.4.197
    - 10.244.4.198
    - 10.244.4.199
    - 10.244.4.200
    - 10.244.4.201
    - 10.244.4.202
    - 10.244.4.203
    - 10.244.4.204
    - 10.244.4.205
    - 10.244.4.206
    - 10.244.4.207
    - 10.244.4.208
    - 10.244.4.209
    - 10.244.4.210
    - 10.244.4.211
    - 10.244.4.212
    - 10.244.4.213
    - 10.244.4.214
    - 10.244.4.215
    - 10.244.4.216
    - 10.244.4.217
    - 10.244.4.218
    - 10.244.4.219
    - 10.244.4.220
    - 10.244.4.221
    - 10.244.4.222
    - 10.244.4.223
    - 10.244.4.224
    - 10.244.4.225
    - 10.244.4.226
    - 10.244.4.227
    - 10.244.4.228
    - 10.244.4.229
    - 10.244.4.230
    - 10.244.4.231
    - 10.244.4.232
    - 10.244.4.233
    - 10.244.4.234
    - 10.244.4.235
    - 10.244.4.236
    - 10.244.4.237
    - 10.244.4.238
    - 10.244.4.239
    - 10.244.4.240
    - 10.244.4.241
    - 10.244.4.242
    - 10.244.4.243
    - 10.244.4.244
    - 10.244.4.245
    - 10.244.4.246
    - 10.244.4.247
    - 10.244.4.248
    - 10.244.4.249
    - 10.244.4.250
    - 10.244.4.251
    - 10.244.4.252
    - 10.244.4.253
    - 10.244.4.254
  type: manual

properties:
  etcd:
    cluster:
    - instances: 1
      name: etcd_z1
    machines:
    - etcd.service.cf.internal
    peer_require_ssl: true
    require_ssl: true
    heartbeat_interval_in_milliseconds: 50
    advertise_urls_dns_suffix: etcd.service.cf.internal
    ca_cert: etcd-ca-cert
    client_cert: etcd-client-cert
    client_key: etcd-client-key
    peer_ca_cert: etcd-peer-ca-cert
    peer_cert: etcd-peer-cert
    peer_key: etcd-peer-key
    server_cert: etcd-server-cert
    server_key: etcd-server-key
  consul:
    agent:
      domain: cf.internal
      servers:
        lan:
        - 10.244.4.45
    encrypt_keys:
    - consul-encrypt-key
    agent_cert: consul-agent-cert
    agent_key: consul-agent-key
    ca_cert: consul-ca-cert
    server_cert: consul-server-cert
    server_key: consul-server-key

releases:
- name: consul
  version: latest
- name: etcd
  version: latest

resource_pools:
- cloud_properties: {}
  name: etcd_z1
  network: etcd1
  stemcell:
    name: bosh-warden-boshlite-ubuntu-trusty-go_agent
    version: latest

update:
  canaries: 1
  canary_watch_time: 1000-180000
  max_in_flight: 1
  serial: true
  update_watch_time: 1000-180000

